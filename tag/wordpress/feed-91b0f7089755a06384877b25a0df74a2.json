{
    "version": "https://jsonfeed.org/version/1",
    "title": "Qualityology - Let's get the most out of life! â€¢ All posts by \"wordpress\" tag",
    "description": "To uncover the best way to achieve desired level of quality in everything. - We dive deep on adding quality to tech gadgets, business, and entertainment because quality matter in life.",
    "home_page_url": "https://www.qualityology.com",
    "items": [
        {
            "id": "https://www.qualityology.com/tech/29-code-snippets-for-wordpress-users/",
            "url": "https://www.qualityology.com/tech/29-code-snippets-for-wordpress-users/",
            "title": "29 Code Snippets for WordPress Users",
            "date_published": "2021-02-23T20:09:23.000Z",
            "content_html": "<p>Tired of installing tons of WordPress plugins for small features? You can use code snippets to do certain things without a dedicated plugin. Generally the <code>functions.php</code> file is the place to add code snippes.</p>\n<p>If you don&#x2019;t want to edit PHP file and want to gain more fine control over code snippets? You should try out <strong>Code Snippets</strong> plugin. With <strong>Code Snippets</strong>, you can easily add PHP code snippets to your WordPress site without custom snippets in theme&#x2019;s <code>functions.php</code> file. Search <code>Code Snippets</code> in WordPress&#x2019;s Add Plugins page and install it. You can start adding code snippet just like how you write post.</p>\n<p>We collected some very useful code snippets for WordPress. All can be used with Code Snippets plugin or added it directly to PHP file.</p>\n<h2 id=\"1-Auto-update-plug-and-theme\"><a href=\"#1-Auto-update-plug-and-theme\" class=\"headerlink\" title=\"1. Auto update plug and theme\"></a>1. Auto update plug and theme</h2><figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">add_filter( &apos;auto_update_plugin&apos;, &apos;__return_true&apos; );</span><br><span class=\"line\">add_filter( &apos;auto_update_theme&apos;, &apos;__return_true&apos; );</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-Remove-all-HTML-Comments-and-space\"><a href=\"#2-Remove-all-HTML-Comments-and-space\" class=\"headerlink\" title=\"2. Remove all HTML Comments and space\"></a>2. Remove all HTML Comments and space</h2><figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function callback($buffer) {</span><br><span class=\"line\">  $search = array(</span><br><span class=\"line\">\t&apos;/\\n/&apos;,</span><br><span class=\"line\">        &apos;/\\&gt;[^\\S ]+/s&apos;,  // strip whitespaces after tags, except space</span><br><span class=\"line\">        &apos;/[^\\S ]+\\&lt;/s&apos;,  // strip whitespaces before tags, except space</span><br><span class=\"line\">        &apos;/(\\s)+/s&apos;,       // shorten multiple whitespace sequences</span><br><span class=\"line\">\t&apos;/&lt;!--(.|s)*?--&gt;/&apos;</span><br><span class=\"line\">    );</span><br><span class=\"line\"></span><br><span class=\"line\">    $replace = array(</span><br><span class=\"line\">\t  &apos;&apos;,</span><br><span class=\"line\">        &apos;&gt;&apos;,</span><br><span class=\"line\">        &apos;&lt;&apos;,</span><br><span class=\"line\">        &apos;\\\\1&apos;,</span><br><span class=\"line\">\t &apos;&apos;</span><br><span class=\"line\">    );</span><br><span class=\"line\">  </span><br><span class=\"line\">    #$buffer = preg_replace(&apos;/&lt;!--(.|s)*?--&gt;/&apos;, &apos;&apos;, $buffer);</span><br><span class=\"line\">  \t$buffer = preg_replace($search, $replace, $buffer);</span><br><span class=\"line\">    return $buffer;</span><br><span class=\"line\">}</span><br><span class=\"line\">function buffer_start() {</span><br><span class=\"line\">    ob_start(&quot;callback&quot;);</span><br><span class=\"line\">}</span><br><span class=\"line\">function buffer_end() {</span><br><span class=\"line\">    ob_end_flush();</span><br><span class=\"line\">}</span><br><span class=\"line\">add_action(&apos;get_header&apos;, &apos;buffer_start&apos;);</span><br><span class=\"line\">add_action(&apos;wp_footer&apos;, &apos;buffer_end&apos;, 9999);</span><br></pre></td></tr></table></figure>\n<h2 id=\"3-Add-DNS-Prefetching\"><a href=\"#3-Add-DNS-Prefetching\" class=\"headerlink\" title=\"3. Add DNS Prefetching\"></a>3. Add DNS Prefetching</h2><figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//* Adding DNS Prefetching</span><br><span class=\"line\">function stb_dns_prefetch() {</span><br><span class=\"line\">echo &apos;&lt;meta http-equiv=&quot;x-dns-prefetch-control&quot; content=&quot;on&quot;&gt;</span><br><span class=\"line\">&lt;link rel=&quot;dns-prefetch&quot; href=&quot;//pagead2.googlesyndication.com&quot; /&gt;</span><br><span class=\"line\">&lt;link rel=&quot;dns-prefetch&quot; href=&quot;//googleads.g.doubleclick.net&quot; /&gt;</span><br><span class=\"line\">&lt;link rel=&quot;dns-prefetch&quot; href=&quot;//www.google-analytics.com&quot; /&gt;</span><br><span class=\"line\">&lt;link rel=&quot;dns-prefetch&quot; href=&quot;//s.gravatar.com/&quot; /&gt;&apos;;</span><br><span class=\"line\">}</span><br><span class=\"line\">add_action(&apos;wp_head&apos;, &apos;stb_dns_prefetch&apos;, 1);</span><br></pre></td></tr></table></figure>\n<h2 id=\"4-Stop-loading-wp-emoji-release-min-js\"><a href=\"#4-Stop-loading-wp-emoji-release-min-js\" class=\"headerlink\" title=\"4. Stop loading wp-emoji-release.min.js\"></a>4. Stop loading wp-emoji-release.min.js</h2><figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">remove_action(&apos;wp_head&apos;, &apos;print_emoji_detection_script&apos;, 7);</span><br><span class=\"line\">remove_action(&apos;wp_print_styles&apos;, &apos;print_emoji_styles&apos;);</span><br></pre></td></tr></table></figure>\n<h2 id=\"5-Prefer-loading-jquery-JavaScript-with-async-and-defer-tag\"><a href=\"#5-Prefer-loading-jquery-JavaScript-with-async-and-defer-tag\" class=\"headerlink\" title=\"5. Prefer loading jquery JavaScript with async and defer tag\"></a>5. Prefer loading jquery JavaScript with async and defer tag</h2><figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if (!is_admin()) {</span><br><span class=\"line\">    add_filter( &apos;script_loader_tag&apos;, function ( $tag, $handle ) {    </span><br><span class=\"line\">        if ( strpos( $tag, &quot;jquery.min.js&quot; ) || strpos( $tag, &quot;jquery.js&quot;) ) {</span><br><span class=\"line\">            return $tag;</span><br><span class=\"line\">        }</span><br><span class=\"line\">        return str_replace( &apos; src&apos;, &apos; async src&apos;, $tag );</span><br><span class=\"line\">    }, 10, 2 );</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n<h2 id=\"6-Load-CDN-jQuery-from-Google\"><a href=\"#6-Load-CDN-jQuery-from-Google\" class=\"headerlink\" title=\"6. Load CDN jQuery from Google\"></a>6. Load CDN jQuery from Google</h2><figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// Load CDN jQuery </span><br><span class=\"line\">add_action( &apos;wp_enqueue_scripts&apos;, &apos;register_jquery&apos; );</span><br><span class=\"line\">function register_jquery() {</span><br><span class=\"line\">    if (!is_admin() &amp;&amp; $GLOBALS[&apos;pagenow&apos;] != &apos;wp-login.php&apos;) {</span><br><span class=\"line\">        // comment out the next two lines to load the local copy of jQuery</span><br><span class=\"line\">        wp_deregister_script(&apos;jquery&apos;);</span><br><span class=\"line\">        wp_register_script(&apos;jquery&apos;, &apos;https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js&apos;, false, &apos;3.2.1&apos;);</span><br><span class=\"line\">        wp_enqueue_script(&apos;jquery&apos;);</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br><span class=\"line\">// end</span><br></pre></td></tr></table></figure>\n<h2 id=\"7-Remove-jQuery-Migrate-script-from-header-New-plugin-will-not-have-incompatibility-issue\"><a href=\"#7-Remove-jQuery-Migrate-script-from-header-New-plugin-will-not-have-incompatibility-issue\" class=\"headerlink\" title=\"7. Remove jQuery-Migrate script from header (New plugin will not have incompatibility issue)\"></a>7. Remove jQuery-Migrate script from header (New plugin will not have incompatibility issue)</h2><figure class=\"highlight plain hljs\"><figcaption><span>Remove migrate script</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">add_filter( &apos;wp_default_scripts&apos;, &apos;remove_jquery_migrate&apos; );</span><br><span class=\"line\">function remove_jquery_migrate( &amp;$scripts)</span><br><span class=\"line\">  {</span><br><span class=\"line\">  \tif(!is_admin())  {</span><br><span class=\"line\">      $scripts-&gt;remove( &apos;jquery&apos;);</span><br><span class=\"line\">      $scripts-&gt;add( &apos;jquery&apos;, false, array( &apos;jquery-core&apos; ), &apos;1.10.2&apos; );</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n<h2 id=\"8-No-self-pings\"><a href=\"#8-No-self-pings\" class=\"headerlink\" title=\"8. No self pings\"></a>8. No self pings</h2><figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// No Self Pings</span><br><span class=\"line\">function no_self_ping( &amp;$links ) {</span><br><span class=\"line\">  $home = get_option( &apos;home&apos; );</span><br><span class=\"line\">  foreach ( $links as $l =&gt; $link )</span><br><span class=\"line\">  if ( 0 === strpos( $link, $home ) )</span><br><span class=\"line\">  unset($links[$l]);</span><br><span class=\"line\">}</span><br><span class=\"line\">add_action( &apos;pre_ping&apos;, &apos;no_self_ping&apos; );</span><br></pre></td></tr></table></figure>\n<h2 id=\"9-Add-p-tag-to-lt-more-gt\"><a href=\"#9-Add-p-tag-to-lt-more-gt\" class=\"headerlink\" title=\"9. Add p tag to &lt;!--more--&gt;\"></a>9. Add p tag to <code>&lt;!--more--&gt;</code></h2><figure class=\"highlight plain hljs\"><figcaption><span>tag detection</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function has_more()</span><br><span class=\"line\">{</span><br><span class=\"line\"> global $post;</span><br><span class=\"line\"> if ( empty( $post ) ) return;</span><br><span class=\"line\"></span><br><span class=\"line\">    if ($pos=strpos($post-&gt;post_content, &apos;&lt;!--more--&gt;&apos;)) {</span><br><span class=\"line\">        return true;</span><br><span class=\"line\">    } else {</span><br><span class=\"line\">        return false;</span><br><span class=\"line\">    }</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\">//add p tag to more tag</span><br><span class=\"line\">function add_p_tag($link){</span><br><span class=\"line\">return &quot;&lt;p&gt;$link&lt;/p&gt;&quot;;</span><br><span class=\"line\">}</span><br><span class=\"line\">add_filter(&apos;the_content_more_link&apos;, &apos;add_p_tag&apos;); </span><br></pre></td></tr></table></figure>\n<h2 id=\"10-Inject-google-ads-after-n-link\"><a href=\"#10-Inject-google-ads-after-n-link\" class=\"headerlink\" title=\"10. Inject google ads after n link\"></a>10. Inject google ads after n link</h2><figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function inject_ad_text_after_n_chars($content) {</span><br><span class=\"line\">  // insert after the first &lt;/a&gt; after x characters</span><br><span class=\"line\">  $after_character = 1;</span><br><span class=\"line\">  if (is_single()) {</span><br><span class=\"line\">    $before_content = substr($content, 0,  $after_character);</span><br><span class=\"line\">    $after_content = substr($content, $after_character);</span><br><span class=\"line\">    $after_content = explode(&apos;&lt;/p&gt;&apos;, $after_content);</span><br><span class=\"line\">    $text = &apos;&lt;ins class=&quot;adsbygoogle&quot;</span><br><span class=\"line\">     style=&quot;display:block&quot;</span><br><span class=\"line\">     data-ad-client=&quot;your id&quot;</span><br><span class=\"line\">     data-ad-slot=&quot;your ad slot&quot;</span><br><span class=\"line\">     data-ad-format=&quot;auto&quot;&gt;&lt;/ins&gt;</span><br><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">(adsbygoogle = window.adsbygoogle || []).push({});</span><br><span class=\"line\">&lt;/script&gt;&lt;/p&gt;&apos;;</span><br><span class=\"line\">    array_splice($after_content, 1, 0, $text);</span><br><span class=\"line\">    $after_content = implode(&apos;&apos;, $after_content);</span><br><span class=\"line\">    return $before_content . $after_content;</span><br><span class=\"line\">  }</span><br><span class=\"line\">  else {</span><br><span class=\"line\">    return $content;</span><br><span class=\"line\">  }</span><br><span class=\"line\">}</span><br><span class=\"line\">add_filter(&apos;the_content&apos;, &apos;inject_ad_text_after_n_chars&apos;, 13);</span><br></pre></td></tr></table></figure>\n<h2 id=\"11-Delay-auto-closing-p-tag-to-fix-some-problems\"><a href=\"#11-Delay-auto-closing-p-tag-to-fix-some-problems\" class=\"headerlink\" title=\"11. Delay auto closing p tag to fix some problems.\"></a>11. Delay auto closing p tag to fix some problems.</h2><figure class=\"highlight plain hljs\"><figcaption><span>auto closing p tag to fix some problems.</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">remove_filter( &apos;the_content&apos;, &apos;wpautop&apos; );</span><br><span class=\"line\">add_filter( &apos;the_content&apos;, &apos;wpautop&apos; , 12);</span><br></pre></td></tr></table></figure>\n<h2 id=\"12-Show-Media-upload-path\"><a href=\"#12-Show-Media-upload-path\" class=\"headerlink\" title=\"12. Show Media upload path\"></a>12. Show Media upload path</h2><figure class=\"highlight plain hljs\"><figcaption><span>Media upload</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if(get_option(&apos;upload_path&apos;)==&apos;wp-content/uploads&apos; || get_option(&apos;upload_path&apos;)==null) {</span><br><span class=\"line\">\tupdate_option(&apos;upload_path&apos;,WP_CONTENT_DIR.&apos;uploads&apos;);</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n<h2 id=\"13-Image-SEO-with-size-and-height-info\"><a href=\"#13-Image-SEO-with-size-and-height-info\" class=\"headerlink\" title=\"13. Image SEO, with size and height info\"></a>13. Image SEO, with size and height info</h2><figure class=\"highlight plain hljs\"><figcaption><span>get_post_image ($post_id</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// select the post content from the db</span><br><span class=\"line\">$image_id = get_post_thumbnail_id();</span><br><span class=\"line\">$image_url = wp_get_attachment_image_src($image_id,&apos;large&apos;);</span><br><span class=\"line\">$the_image_src = $image_url[0];</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t  // if src found, then create a new img tag</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t  if(strlen($the_image_src)) {</span><br><span class=\"line\">\t\t\t   if(strlen($img_script)) {</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t\t\t    // if the src starts with http/https, then strip out server name</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">\t\t\t\t    if(preg_match(&quot;/^(http(|s):\\/\\/)/&quot;, $the_image_src)) {</span><br><span class=\"line\">\t\t\t\t\t     $the_image_src = preg_replace(&quot;/^(http(|s):\\/\\/)/&quot;, &apos;&apos;, $the_image_src);</span><br><span class=\"line\">\t\t\t\t\t     $frags = split(&quot;\\/&quot;, $the_image_src);</span><br><span class=\"line\">\t\t\t\t\t     array_shift($frags);</span><br><span class=\"line\">\t\t\t\t\t     $the_image_src = &apos;/&apos; . join(&quot;/&quot;, $frags);</span><br><span class=\"line\">\t\t\t\t    }</span><br><span class=\"line\">\t\t\t\t    $the_image = &apos;&lt;img class=&quot;&apos; . $class . &apos;&quot; alt=&quot;&apos; . $alt . &apos;&quot; src=&quot;&apos; . $img_script . $the_image_src . &apos;&quot; width=&quot;&apos; . $width . &apos;&quot; height=&quot;&apos; . $height . &apos;&quot;/&gt;&apos;;</span><br><span class=\"line\">\t\t\t   }</span><br><span class=\"line\">\t\t\t   else {</span><br><span class=\"line\">\t\t\t\t    $the_image = &apos;&lt;img class=&quot;&apos; . $class . &apos;&quot; alt=&quot;&apos; . $alt . &apos;&quot; src=&quot;&apos; . $the_image_src . &apos;&quot; width=&quot;&apos; . $width . &apos;&quot; height=&quot;&apos; . $height . &apos;&quot; width=&quot;&apos; . $width . &apos;&quot; height=&quot;&apos; . $height . &apos;&quot;/&gt;&apos;;</span><br><span class=\"line\">\t\t\t   }</span><br><span class=\"line\">\t\t  }</span><br><span class=\"line\">       </span><br><span class=\"line\">       // if there&apos;s no image</span><br><span class=\"line\">       else</span><br><span class=\"line\">         return false;</span><br><span class=\"line\">         </span><br><span class=\"line\">\t\t  return $the_image;</span><br><span class=\"line\">\t }</span><br></pre></td></tr></table></figure>\n<h2 id=\"14-Add-Nofollow-to-comments-link\"><a href=\"#14-Add-Nofollow-to-comments-link\" class=\"headerlink\" title=\"14. Add Nofollow to comments link\"></a>14. Add Nofollow to comments link</h2><figure class=\"highlight plain hljs\"><figcaption><span>Nofollow comments line</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#function add_nofollow_to_comments_popup_link(){</span><br><span class=\"line\">#    return &apos; rel=&quot;nofollow&quot; &apos;;}</span><br><span class=\"line\">#add_filter( &apos;comments_popup_link_attributes&apos;, &apos;add_nofollow_to_comments_popup_link&apos; );</span><br><span class=\"line\"></span><br><span class=\"line\">add_filter( &apos;get_comment_author_link&apos;, &apos;rv_remove_comment_author_link&apos;, 10, 3 );</span><br><span class=\"line\">function rv_remove_comment_author_link( $return, $author, $comment_ID ) {</span><br><span class=\"line\">\treturn $author;</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n<h2 id=\"15-Remove-junk-header\"><a href=\"#15-Remove-junk-header\" class=\"headerlink\" title=\"15. Remove junk header\"></a>15. Remove junk header</h2><figure class=\"highlight plain hljs\"><figcaption><span>Remove junk</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#remove_action(&apos;wp_head&apos;, &apos;wp_enqueue_scripts&apos;, 1);</span><br><span class=\"line\">#add_action(&apos;wp_footer&apos;, &apos;wp_enqueue_scripts&apos;, 5);</span><br><span class=\"line\">function ft_rtt_remove_title_attribute( $output ){</span><br><span class=\"line\">  $output = preg_replace(&apos;/title=\\&quot;(.*?)\\&quot;/&apos;,&apos;&apos;,$output);</span><br><span class=\"line\">  return $output;</span><br><span class=\"line\"> }</span><br><span class=\"line\">add_filter(&apos;wp_list_categories&apos;,&apos;ft_rtt_remove_title_attribute&apos;);</span><br><span class=\"line\">add_filter(&apos;wp_list_pages&apos;,&apos;ft_rtt_remove_title_attribute&apos;);</span><br><span class=\"line\">add_filter(&apos;the_category&apos;, &apos;ft_rtt_remove_title_attribute&apos; );</span><br><span class=\"line\">add_filter(&apos;comment_ID&apos;, &apos;ft_rtt_remove_title_attribute&apos; );</span><br><span class=\"line\"></span><br><span class=\"line\">function wpbeginner_remove_version() {</span><br><span class=\"line\">\treturn &apos;&apos;;</span><br><span class=\"line\">}</span><br><span class=\"line\">add_filter(&apos;the_generator&apos;, &apos;wpbeginner_remove_version&apos;);</span><br><span class=\"line\">add_filter(&apos;show_admin_bar&apos;, &apos;__return_false&apos;);</span><br><span class=\"line\">remove_action(&apos;wp_head&apos;,&apos;rsd_link&apos;);</span><br><span class=\"line\">remove_action(&apos;wp_head&apos;,&apos;wlwmanifest_link&apos;);</span><br><span class=\"line\">remove_action( &apos;wp_head&apos;, &apos;index_rel_link&apos; );</span><br><span class=\"line\">remove_action( &apos;wp_head&apos;, &apos;parent_post_rel_link&apos;, 10, 0 );</span><br><span class=\"line\">remove_action( &apos;wp_head&apos;, &apos;start_post_rel_link&apos;, 10, 0 );</span><br><span class=\"line\">remove_action( &apos;wp_head&apos;, &apos;adjacent_posts_rel_link_wp_head&apos;, 10, 0 );</span><br><span class=\"line\">remove_action( &apos;wp_head&apos;, &apos;rel_canonical&apos; );</span><br><span class=\"line\">remove_action( &apos;wp_head&apos;, &apos;wp_shortlink_wp_head&apos;, 10, 0 );</span><br><span class=\"line\">remove_action( &apos;wp_head&apos;, &apos;noindex&apos;, 1 );</span><br><span class=\"line\">remove_filter(&apos;comment_text&apos;, &apos;make_clickable&apos;, 9);</span><br><span class=\"line\">#Remove Wordpress Comment Feed Link from header</span><br><span class=\"line\">#Display the links to the extra feeds such as category feeds</span><br><span class=\"line\">remove_action(&apos;wp_head&apos;, &apos;feed_links_extra&apos;, 3);</span><br><span class=\"line\">#Display the links to the general feeds: Post and Comment Feed</span><br><span class=\"line\">remove_action(&apos;wp_head&apos;, &apos;feed_links&apos;, 2);</span><br><span class=\"line\"></span><br><span class=\"line\">$qmr_work_tags = array(</span><br><span class=\"line\">  &apos;the_title&apos;,</span><br><span class=\"line\">  &apos;the_content&apos;,</span><br><span class=\"line\">  &apos;the_excerpt&apos;,</span><br><span class=\"line\">  &apos;comment_text&apos;,</span><br><span class=\"line\">  &apos;list_cats&apos;,</span><br><span class=\"line\">  &apos;single_post_title&apos;,</span><br><span class=\"line\">  &apos;comment_author&apos;,</span><br><span class=\"line\">  &apos;term_name&apos;,</span><br><span class=\"line\">  &apos;link_name&apos;,</span><br><span class=\"line\">  &apos;link_description&apos;,</span><br><span class=\"line\">  &apos;link_notes&apos;,</span><br><span class=\"line\">  &apos;bloginfo&apos;,</span><br><span class=\"line\">  &apos;wp_title&apos;,</span><br><span class=\"line\">  &apos;widget_title&apos;,</span><br><span class=\"line\">  &apos;term_description&apos;,</span><br><span class=\"line\">  &apos;category_description&apos;,</span><br><span class=\"line\">  &apos;widget_text&apos;</span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\">foreach ( $qmr_work_tags as $qmr_work_tag ) {</span><br><span class=\"line\">remove_filter ($qmr_work_tag, &apos;wptexturize&apos;);</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n<h2 id=\"16-Remove-category-in-url\"><a href=\"#16-Remove-category-in-url\" class=\"headerlink\" title=\"16. Remove category in url\"></a>16. Remove category in url</h2><figure class=\"highlight plain hljs\"><figcaption><span>Remove category, together with plugin</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function fix_slash( $string, $type )</span><br><span class=\"line\">{</span><br><span class=\"line\">    global $wp_rewrite;</span><br><span class=\"line\">    if ( $wp_rewrite-&gt;use_trailing_slashes == false )</span><br><span class=\"line\">    {</span><br><span class=\"line\">        if ( $type != &apos;single&apos; &amp;&amp; $type != &apos;category&apos; )</span><br><span class=\"line\">            return trailingslashit( $string );</span><br><span class=\"line\"> </span><br><span class=\"line\">        if ( $type == &apos;single&apos; &amp;&amp; ( strpos( $string, &apos;.html/&apos; ) !== false ) )</span><br><span class=\"line\">            return trailingslashit( $string );</span><br><span class=\"line\"> </span><br><span class=\"line\">        if ( $type == &apos;category&apos; &amp;&amp; ( strpos( $string, &apos;category&apos; ) !== false ) )</span><br><span class=\"line\">        {</span><br><span class=\"line\">            $aa_g = str_replace( &quot;/category/&quot;, &quot;/&quot;, $string );</span><br><span class=\"line\">            return trailingslashit( $aa_g );</span><br><span class=\"line\">        }</span><br><span class=\"line\">        if ( $type == &apos;category&apos; )</span><br><span class=\"line\">            return trailingslashit( $string );</span><br><span class=\"line\">    }</span><br><span class=\"line\">    return $string;</span><br><span class=\"line\">}</span><br><span class=\"line\"> </span><br><span class=\"line\">add_filter( &apos;user_trailingslashit&apos;, &apos;fix_slash&apos;, 55, 2 );</span><br></pre></td></tr></table></figure>\n<h2 id=\"17-Add-SEO-title-attributes-next-post-link-previous-post-link\"><a href=\"#17-Add-SEO-title-attributes-next-post-link-previous-post-link\" class=\"headerlink\" title=\"17. Add SEO title attributes next post link, previous post link\"></a>17. Add SEO title attributes next post link, previous post link</h2><figure class=\"highlight plain hljs\"><figcaption><span>Title attributes to next and previous post link functions</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">add_filter(&apos;next_post_link&apos;,&apos;add_title_to_next_post_link&apos;);</span><br><span class=\"line\">function add_title_to_next_post_link($link) {</span><br><span class=\"line\">  global $post;</span><br><span class=\"line\">  $post = get_post($post_id);</span><br><span class=\"line\">  $next_post = get_next_post();</span><br><span class=\"line\">  $title = $next_post-&gt;post_title;</span><br><span class=\"line\">  $link = str_replace(&quot;rel=&quot;, &quot; title=&apos;&quot;.$title.&quot;&apos; rel=&quot;, $link);</span><br><span class=\"line\">  return $link;</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\">add_filter(&apos;previous_post_link&apos;,&apos;add_title_to_previous_post_link&apos;);</span><br><span class=\"line\">function add_title_to_previous_post_link($link) {</span><br><span class=\"line\">  global $post;</span><br><span class=\"line\">  $post = get_post($post_id);</span><br><span class=\"line\">  $previous_post = get_previous_post();</span><br><span class=\"line\">  $title = $previous_post-&gt;post_title;</span><br><span class=\"line\">  $link = str_replace(&quot;rel=&quot;, &quot; title=&apos;&quot;.$title.&quot;&apos; rel=&quot;, $link);</span><br><span class=\"line\">  return $link;</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n<h2 id=\"18-Remove-rel-from-category-tag\"><a href=\"#18-Remove-rel-from-category-tag\" class=\"headerlink\" title=\"18. Remove rel from category tag\"></a>18. Remove rel from category tag</h2><figure class=\"highlight plain hljs\"><figcaption><span>Remove rel</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function remove_rel($result) {</span><br><span class=\"line\">  $result = str_replace(&apos; rel=&quot;category tag&quot;&apos;, &apos;rel=&quot;tag&quot;&apos;, $result);</span><br><span class=\"line\">  return $result;</span><br><span class=\"line\">}</span><br><span class=\"line\">add_filter(&apos;wp_list_categories&apos;, &apos;remove_rel&apos;);</span><br><span class=\"line\">add_filter(&apos;the_category&apos;, &apos;remove_rel&apos;);</span><br></pre></td></tr></table></figure>\n<h2 id=\"19-Remove-query-strings-from-static-resources\"><a href=\"#19-Remove-query-strings-from-static-resources\" class=\"headerlink\" title=\"19. Remove query strings from static resources\"></a>19. Remove query strings from static resources</h2><figure class=\"highlight plain hljs\"><figcaption><span>query strings from static resources</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function ewp_remove_script_version( $src ){</span><br><span class=\"line\">  return remove_query_arg( &apos;ver&apos;, $src );</span><br><span class=\"line\">}</span><br><span class=\"line\">add_filter( &apos;script_loader_src&apos;, &apos;ewp_remove_script_version&apos;, 15, 1 );</span><br><span class=\"line\">add_filter( &apos;style_loader_src&apos;, &apos;ewp_remove_script_version&apos;, 15, 1 );</span><br><span class=\"line\"></span><br><span class=\"line\">#remove header recent comment style</span><br><span class=\"line\">add_action(&apos;widgets_init&apos;, &apos;my_remove_recent_comments_style&apos;);</span><br><span class=\"line\">function my_remove_recent_comments_style() {</span><br><span class=\"line\">\tglobal $wp_widget_factory;</span><br><span class=\"line\">\tremove_action(&apos;wp_head&apos;, array($wp_widget_factory-&gt;widgets[&apos;WP_Widget_Recent_Comments&apos;], &apos;recent_comments_style&apos;));</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n<h2 id=\"20-Add-alt-tags-to-thumbnail\"><a href=\"#20-Add-alt-tags-to-thumbnail\" class=\"headerlink\" title=\"20. Add alt tags to thumbnail\"></a>20. Add alt tags to thumbnail</h2><figure class=\"highlight plain hljs\"><figcaption><span>&apos;add_attachment&apos;, &apos;my_set_image_meta_upon_image_upload&apos; );</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function my_set_image_meta_upon_image_upload( $post_ID ) {</span><br><span class=\"line\"></span><br><span class=\"line\">\t// Check if uploaded file is an image, else do nothing</span><br><span class=\"line\"></span><br><span class=\"line\">\tif ( wp_attachment_is_image( $post_ID ) ) {</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t$my_image_title = get_post( $post_ID )-&gt;post_title;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t// Sanitize the title:  remove hyphens, underscores &amp; extra spaces:</span><br><span class=\"line\">\t\t$my_image_title = preg_replace( &apos;%\\s*[-_\\s]+\\s*%&apos;, &apos; &apos;,  $my_image_title );</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t// Sanitize the title:  capitalize first letter of every word (other letters lower case):</span><br><span class=\"line\">\t\t$my_image_title = ucwords( strtolower( $my_image_title ) );</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t// Create an array with the image meta (Title, Caption, Description) to be updated</span><br><span class=\"line\">\t\t// Note:  comment out the Excerpt/Caption or Content/Description lines if not needed</span><br><span class=\"line\">\t\t$my_image_meta = array(</span><br><span class=\"line\">\t\t\t&apos;ID&apos;\t\t=&gt; $post_ID,\t\t\t// Specify the image (ID) to be updated</span><br><span class=\"line\">\t\t\t&apos;post_title&apos;\t=&gt; $my_image_title,\t\t// Set image Title to sanitized title</span><br><span class=\"line\">\t\t\t//&apos;post_excerpt&apos;\t=&gt; $my_image_title,\t\t// Set image Caption (Excerpt) to sanitized title</span><br><span class=\"line\">\t\t\t&apos;post_content&apos;\t=&gt; $my_image_title,\t\t// Set image Description (Content) to sanitized title</span><br><span class=\"line\">\t\t);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t// Set the image Alt-Text</span><br><span class=\"line\">\t\tupdate_post_meta( $post_ID, &apos;_wp_attachment_image_alt&apos;, $my_image_title );</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t// Set the image meta (e.g. Title, Excerpt, Content)</span><br><span class=\"line\">\t\twp_update_post( $my_image_meta );</span><br><span class=\"line\"></span><br><span class=\"line\">\t} </span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n<h2 id=\"21-Add-pre-tag-wrapper-to-code-tag-and-editor-button\"><a href=\"#21-Add-pre-tag-wrapper-to-code-tag-and-editor-button\" class=\"headerlink\" title=\"21. Add pre tag wrapper to code tag, and editor button\"></a>21. Add pre tag wrapper to code tag, and editor button</h2><figure class=\"highlight plain hljs\"><figcaption><span>pre tag</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">add_action(&apos;admin_print_footer_scripts&apos;,&apos;eg_quicktags&apos;);</span><br><span class=\"line\">function eg_quicktags() {</span><br><span class=\"line\">?&gt;</span><br><span class=\"line\">&lt;script type=&quot;text/javascript&quot; charset=&quot;utf-8&quot;&gt;</span><br><span class=\"line\">\tQTags.addButton( &apos;eg_pre&apos;, &apos;Code with Pre&apos;,&apos;&lt;pre&gt;&lt;code&gt;&apos;, &apos;&lt;/code&gt;&lt;/pre&gt;&apos;, &apos;q&apos; );</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\">&lt;?php</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n<h2 id=\"22-Login-page-tweak\"><a href=\"#22-Login-page-tweak\" class=\"headerlink\" title=\"22. Login page tweak\"></a>22. Login page tweak</h2><figure class=\"highlight plain hljs\"><figcaption><span>no_wordpress_errors(){</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">add_filter( &apos;login_errors&apos;, &apos;no_wordpress_errors&apos;);</span><br><span class=\"line\"></span><br><span class=\"line\">function my_login_logo_one() { </span><br><span class=\"line\">?&gt;</span><br><span class=\"line\">&lt;style type=&quot;text/css&quot;&gt; </span><br><span class=\"line\">\tbody.login div#login h1 a {display: none; !important;} </span><br><span class=\"line\">&lt;/style&gt;</span><br><span class=\"line\">&lt;?php </span><br><span class=\"line\">}</span><br><span class=\"line\">add_action( &apos;login_enqueue_scripts&apos;, &apos;my_login_logo_one&apos; );</span><br><span class=\"line\">\t\t\t\t\t  </span><br><span class=\"line\">// changing the logo link from wordpress.org to your site</span><br><span class=\"line\">function mb_login_url() {  return home_url(); }</span><br><span class=\"line\">add_filter( &apos;login_headerurl&apos;, &apos;mb_login_url&apos; );</span><br><span class=\"line\"></span><br><span class=\"line\">// changing the alt text on the logo to show your site name</span><br><span class=\"line\">function mb_login_title() { return get_option( &apos;blogname&apos; ); }</span><br><span class=\"line\">add_filter( &apos;login_headertitle&apos;, &apos;mb_login_title&apos; );</span><br></pre></td></tr></table></figure>\n<h2 id=\"23-Remove-wp-version-param-from-any-enqueued-scripts\"><a href=\"#23-Remove-wp-version-param-from-any-enqueued-scripts\" class=\"headerlink\" title=\"23. Remove wp version param from any enqueued scripts\"></a>23. Remove wp version param from any enqueued scripts</h2><figure class=\"highlight plain hljs\"><figcaption><span>remove wp version param from any enqueued scripts</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function remove_wp_ver_css_js( $src ) {</span><br><span class=\"line\">  if ( strpos( $src, &apos;ver=&apos; . get_bloginfo( &apos;version&apos; ) ) )</span><br><span class=\"line\">  $src = remove_query_arg( &apos;ver&apos;, $src );</span><br><span class=\"line\">  return $src;</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n<h2 id=\"24-Add-X-UA-Compatible-header\"><a href=\"#24-Add-X-UA-Compatible-header\" class=\"headerlink\" title=\"24. Add X-UA-Compatible header\"></a>24. Add X-UA-Compatible header</h2><figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function add_http_header($headers) {</span><br><span class=\"line\">$headers[&apos;X-UA-Compatible&apos;] = &apos;IE=edge,chrome=1&apos;;</span><br><span class=\"line\">return $headers;</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\">add_filter(&apos;wp_headers&apos;, &apos;add_http_header&apos;);</span><br></pre></td></tr></table></figure>\n<h2 id=\"25-Prevent-WordPress-from-participating-in-Pingback-Denial-of-Service-Attacks\"><a href=\"#25-Prevent-WordPress-from-participating-in-Pingback-Denial-of-Service-Attacks\" class=\"headerlink\" title=\"25. Prevent WordPress from participating in Pingback Denial of Service Attacks\"></a>25. Prevent WordPress from participating in Pingback Denial of Service Attacks</h2><figure class=\"highlight plain hljs\"><figcaption><span>Disable xmlrcp/pingback</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">add_filter( &apos;xmlrpc_enabled&apos;, &apos;__return_false&apos; );</span><br><span class=\"line\">add_filter( &apos;pre_update_option_enable_xmlrpc&apos;, &apos;__return_false&apos; );</span><br><span class=\"line\">add_filter( &apos;pre_option_enable_xmlrpc&apos;, &apos;__return_zero&apos; );</span><br><span class=\"line\"></span><br><span class=\"line\">// Disable trackbacks</span><br><span class=\"line\">add_filter( &apos;rewrite_rules_array&apos;, function( $rules ) {</span><br><span class=\"line\">    foreach( $rules as $rule =&gt; $rewrite ) {</span><br><span class=\"line\">        if( preg_match( &apos;/trackback\\/\\?\\$$/i&apos;, $rule ) ) {</span><br><span class=\"line\">            unset( $rules[$rule] );</span><br><span class=\"line\">        }</span><br><span class=\"line\">    }</span><br><span class=\"line\">    return $rules;</span><br><span class=\"line\">});</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">// Disable X-Pingback HTTP Header.</span><br><span class=\"line\">add_filter(&apos;wp_headers&apos;, function($headers, $wp_query){</span><br><span class=\"line\">    if(isset($headers[&apos;X-Pingback&apos;])){</span><br><span class=\"line\">        unset($headers[&apos;X-Pingback&apos;]);</span><br><span class=\"line\">    }</span><br><span class=\"line\">    return $headers;</span><br><span class=\"line\">}, 11, 2);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">add_filter( &apos;xmlrpc_methods&apos;, function($methods){</span><br><span class=\"line\">    unset( $methods[&apos;pingback.ping&apos;] );</span><br><span class=\"line\">    unset( $methods[&apos;pingback.extensions.getPingbacks&apos;] );</span><br><span class=\"line\">    unset( $methods[&apos;wp.getUsersBlogs&apos;] ); // Block brute force discovery of existing users</span><br><span class=\"line\">    unset( $methods[&apos;system.multicall&apos;] );</span><br><span class=\"line\">    unset( $methods[&apos;system.listMethods&apos;] );</span><br><span class=\"line\">    unset( $methods[&apos;system.getCapabilities&apos;] );</span><br><span class=\"line\">    return $methods;</span><br><span class=\"line\">});</span><br></pre></td></tr></table></figure>\n<h2 id=\"26-Include-thumbnail-post-thumb-in-RSS-feed\"><a href=\"#26-Include-thumbnail-post-thumb-in-RSS-feed\" class=\"headerlink\" title=\"26. Include thumbnail (post-thumb) in RSS feed\"></a>26. Include thumbnail (post-thumb) in RSS feed</h2><figure class=\"highlight plain hljs\"><figcaption><span>INCLUDES THE THUMBNAIL IN OUR RSS FEED</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function insertThumbnailRSS($content) {</span><br><span class=\"line\">global $post;</span><br><span class=\"line\">if ( has_post_thumbnail( $post-&gt;ID ) ){</span><br><span class=\"line\">$content = &apos;&lt;p&gt;&apos; . get_the_post_thumbnail( $post-&gt;ID, &apos;post-thumb&apos;, array( &apos;alt&apos; =&gt; get_the_title(), &apos;title&apos; =&gt; get_the_title()) ) . &apos;&lt;/p&gt;&apos; . $content;</span><br><span class=\"line\">}</span><br><span class=\"line\">return $content;</span><br><span class=\"line\">}</span><br><span class=\"line\">add_filter(&apos;the_excerpt_rss&apos;, &apos;insertThumbnailRSS&apos;);</span><br><span class=\"line\">add_filter(&apos;the_content_feed&apos;, &apos;insertThumbnailRSS&apos;);</span><br></pre></td></tr></table></figure>\n<h2 id=\"27-Prevent-Page-Scroll-When-Clicking-the-More-Link\"><a href=\"#27-Prevent-Page-Scroll-When-Clicking-the-More-Link\" class=\"headerlink\" title=\"27. Prevent Page Scroll When Clicking the More Link\"></a>27. Prevent Page Scroll When Clicking the More Link</h2><figure class=\"highlight plain hljs\"><figcaption><span>Page Scroll When Clicking the More Link</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function remove_more_link_scroll( $link ) {</span><br><span class=\"line\">\t$link = preg_replace( &apos;|#more-[0-9]+|&apos;, &apos;&apos;, $link );</span><br><span class=\"line\">\treturn $link;</span><br><span class=\"line\">}</span><br><span class=\"line\">add_filter( &apos;the_content_more_link&apos;, &apos;remove_more_link_scroll&apos; );</span><br></pre></td></tr></table></figure>\n<h2 id=\"28-Convert-links-and-images-to-being-site-root-relative\"><a href=\"#28-Convert-links-and-images-to-being-site-root-relative\" class=\"headerlink\" title=\"28.  Convert links and images to being site root relative\"></a>28.  Convert links and images to being site root relative</h2><figure class=\"highlight plain hljs\"><figcaption><span>Image URLs</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">add_filter(&apos;image_send_to_editor&apos;,&apos;image_to_relative&apos;,5,8);</span><br><span class=\"line\"></span><br><span class=\"line\">function image_to_relative($html, $id, $caption, $title, $align, $url, $size, $alt)</span><br><span class=\"line\">{</span><br><span class=\"line\">\t$sp = strpos($html,&quot;src=&quot;) + 5;</span><br><span class=\"line\">\t$ep = strpos($html,&quot;\\&quot;&quot;,$sp);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t$imageurl = substr($html,$sp,$ep-$sp);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t$relativeurl = str_replace([&quot;http://&quot;, &quot;https://&quot;],&quot;&quot;,$imageurl);</span><br><span class=\"line\">\t$sp = strpos($relativeurl,&quot;/&quot;);</span><br><span class=\"line\">\t$relativeurl = substr($relativeurl,$sp);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t$html = str_replace($imageurl,$relativeurl,$html);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\treturn $html;</span><br><span class=\"line\">}</span><br></pre></td></tr></table></figure>\n<h2 id=\"29-Set-custom-cookie\"><a href=\"#29-Set-custom-cookie\" class=\"headerlink\" title=\"29. Set custom cookie\"></a>29. Set custom cookie</h2><p>If you have server control, you can use this to stop spam.<br><a href=\"https://www.qualityology.com/tech/stop-automated-comment-spam-brute-force-login-attack/\">Stop Automated Comment Spam with Nginx</a></p>\n<figure class=\"highlight plain hljs\"><figcaption><span>Automated Comment Spam with Nginx</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function set_post_cookie() {</span><br><span class=\"line\">    echo &apos;&lt;script&gt;document.cookie = &quot;_pass=1; max-age=1800; path=/; secure&quot;;&lt;/script&gt;&apos; . &quot;&quot;; </span><br><span class=\"line\">}</span><br><span class=\"line\">add_action( &apos;comment_form&apos;, &apos;set_post_cookie&apos;, 100 );</span><br></pre></td></tr></table></figure>",
            "tags": [
                "WordPress"
            ]
        },
        {
            "id": "https://www.qualityology.com/tech/stop-automated-comment-spam-brute-force-login-attack/",
            "url": "https://www.qualityology.com/tech/stop-automated-comment-spam-brute-force-login-attack/",
            "title": "Protect your WordPress from Automated Comment Spam and Brute Force Login Attack",
            "date_published": "2018-04-12T23:57:49.000Z",
            "content_html": "<p>Is your WordPress flooded with spam comment or being attacked by brute force login attempt? Thinking about spam blocking plugin? There are a lot of plug in can help you stop spam comment. You will notice it put thousands spam comments into spam folder after a while. Those Anti-Spam did a great job stopping spam comment show up in our post. There is some drawbacks for that kind of plugin. First,spam comments will be processed and store in your database before it gets deleted manually or automatically. Second, plugin like Akismet Anti-Spam will add a java-script to your site. If your site has limited resources, these kind of activities will drag down your site&#x2019;s performance. If you use captcha plugin, you will also interrupt user&#x2019;s experience.</p>\n<p>If you are looking for a light way to block the spam bot before the comment get posted. Yes, we have one. We can block the spam bot and also protect your login page at the same time, Spam bots&#x2019; comments will not even reach the server. Unless you got hit with spam from real human. This method is almost perfect and very light to your server. It has no captcha, no moderation queues, no complicate settings page, and 99.99% filter rate. This idea is inspired by this <a href=\"https://www.rtcx.net/stop-automated-comment-spam-wordpress\">Stop Automated Comment Spam on WordPress with Nginx.</a> <strong>How this work?</strong> Most spam bot will not process contents from server, including js and cookies. Their job is to get the comment form and post. So we can use java-script and cookies to block spam bot when they try to post any word.</p>\n<ul>\n<li>  When post is viewed, browser will set a small cookie named _pass into viewer&#x2019;s system.</li>\n<li>  If viewer attempted to post a comment, Nginx or Apache will check if they have that cookie in their system. Comment will go through if cookie found. Otherwise, it will shows 403 to block the access.</li>\n<li>  Since the cookie is set no matter viewer is attempt to leave comment or not, we can use the same cookie to prevent brute force login attack. Most spam bot and attack tools are not able to store cookie so the same theory work for both.</li>\n</ul>\n<p><strong>What you need?</strong></p>\n<ul>\n<li>  Access to server&#x2019;s configuration file.&#xA0;(Nginx or Apache&#x2019;s config file)</li>\n<li>  Ability to change something.</li>\n</ul>\n<h2 id=\"Step-one-add-code-to-set-cookie\"><a href=\"#Step-one-add-code-to-set-cookie\" class=\"headerlink\" title=\"Step one, add code to set cookie.\"></a>Step one, add code to set cookie.</h2><p>You can add below code via Code Snippets or directly to theme&#x2019;s function.php file. For HTTPS:</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function set_post_cookie() {</span><br><span class=\"line\">echo &apos;&lt;script&gt;document.cookie = &quot;_pass=1; max-age=43200; path=/; secure&quot;;&lt;/script&gt;&apos; . &quot;n&quot;; </span><br><span class=\"line\">}</span><br><span class=\"line\">add_action( &apos;comment_form&apos;, &apos;set_post_cookie&apos;, 100 );</span><br></pre></td></tr></table></figure>\n<p>This will set a cookie &#x201C;human&#x201D; and value is &#x201C;1&#x201D;. You can change the cookie name and value to whatever you want. If you use HTTP, remove the the work secure from above code.</p>\n<h2 id=\"Step-two-add-below-code-to-check-and-block-spam-bot-with-Nginx-Apache\"><a href=\"#Step-two-add-below-code-to-check-and-block-spam-bot-with-Nginx-Apache\" class=\"headerlink\" title=\"Step two, add below code to check and block spam bot with Nginx/Apache\"></a>Step two, add below code to check and block spam bot with Nginx/Apache</h2><p><strong>For NGINX:</strong></p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#Stop Automated Comment Spam and log in attempt with Nginx</span><br><span class=\"line\">if ($request_uri ~* /wp.comments.post.php/wp-login.php) { set $block_flag 1; }</span><br><span class=\"line\">if ($http_cookie ~* _pass) { set $block_flag 0; }</span><br><span class=\"line\">if ($block_flag) {</span><br><span class=\"line\">        return 403;</span><br><span class=\"line\">    }</span><br></pre></td></tr></table></figure>\n<p><strong>For Apache:</strong></p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">RewriteCond %{REQUEST_URI} ^/wp.comments.post.php?$ [OR]</span><br><span class=\"line\">RewriteCond %{REQUEST_URI} ^(.*)?wp-login\\.php(.*)$</span><br><span class=\"line\">RewriteCond %{HTTP_COOKIE} !_pass</span><br><span class=\"line\">RewriteRule ^forbid/(.*)$ - [F]</span><br></pre></td></tr></table></figure>\n<h2 id=\"Step-three-reset-the-cookie-for-failed-login-attempt\"><a href=\"#Step-three-reset-the-cookie-for-failed-login-attempt\" class=\"headerlink\" title=\"Step three, reset the cookie for failed login attempt\"></a>Step three, reset the cookie for failed login attempt</h2><p>Every time incorrect login attempted cookie will be remove to prevent brute force login attack. Add below codes to functions.php of your theme</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function no_wordpress_errors(){</span><br><span class=\"line\">echo &apos;&lt;script&gt;document.cookie = &quot;_pass=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; secure&quot;;&lt;/script&gt;&apos; . &quot;&quot;;</span><br><span class=\"line\">$ip=$_SERVER[&apos;REMOTE_ADDR&apos;];</span><br><span class=\"line\">$message = &quot;Your are blocked. IP address $ip&quot;;</span><br><span class=\"line\">return $message;</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\">add_filter( &apos;login_errors&apos;, &apos;no_wordpress_errors&apos;);</span><br></pre></td></tr></table></figure>\n<h3 id=\"JavaScript-must-be-turned-on-and-browser-must-accept-cookie-for-this-system-to-work\"><a href=\"#JavaScript-must-be-turned-on-and-browser-must-accept-cookie-for-this-system-to-work\" class=\"headerlink\" title=\"JavaScript must be turned on and browser must accept cookie for this system to work.\"></a>JavaScript must be turned on and browser must accept cookie for this system to work.</h3><p>Remember! Next time when you try to login your admin page, open a post first so you will have the cookie and will not be blocked by this.</p>\n",
            "tags": [
                "WordPress",
                "Apache",
                "Nginx"
            ]
        },
        {
            "id": "https://www.qualityology.com/tech/build-extremely-fast-wordpress-gcp-part-2-nginx/",
            "url": "https://www.qualityology.com/tech/build-extremely-fast-wordpress-gcp-part-2-nginx/",
            "title": "Build an extremely fast WordPress with GCP Part 2: Nginx",
            "date_published": "2017-10-01T05:11:32.000Z",
            "content_html": "<p>Apache or Nginx, what softwares should be used to for your server to achieve the maximum performance? If you have a small free server from GCP from <a href=\"https://www.qualityology.com/tech/build-an-extremely-fast-wordpress-gcp-part1-server/\">part 1</a>, and you want it to be able to handle average 1000 clients per second, Nginx is the best option. Apache use more server resources and must be configured properly to get the best performance. Nginx can handle very large amount of traffic even in a limited environment. We have done the loading test with the server from Google Cloud Platform from <a href=\"https://www.qualityology.com/tech/build-an-extremely-fast-wordpress-gcp-part1-server/\">part 1</a>&#xA0;and the result was great without deep optimization. 1000 client/sec is not the maximum that this setup can get, it is the limit of the free test we could get. <img src=\"/2017/09/loading-test-result-28bbf2cfcf185cb53e2eba4440a4ca31.png\"> When we tried the same test using Apache, the test was aborted at the beginning because server crashed. That is why we will use Nginx. We are not the server expert, so we will not discuss how to optimize Apache to pass the same test. What we will need is NGINX + MySQL + PHP-FPM +&#xA0;Microcaching + WordPress.</p>\n<h2 id=\"Step-1-install-Nginx\"><a href=\"#Step-1-install-Nginx\" class=\"headerlink\" title=\"Step 1, install Nginx.\"></a>Step 1, install Nginx.</h2><figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get update -y</span><br><span class=\"line\">sudo apt-get install nginx -y</span><br><span class=\"line\">sudo service nginx start</span><br></pre></td></tr></table></figure>\n<h2 id=\"Step-2-install-Mysql-or-MariaDB\"><a href=\"#Step-2-install-Mysql-or-MariaDB\" class=\"headerlink\" title=\"Step 2, install Mysql (or MariaDB).\"></a>Step 2, install Mysql (or MariaDB).</h2><figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install mysql-server -y</span><br><span class=\"line\">sudo service mysql stop</span><br><span class=\"line\">sudo mysql_install_db # follow instructions</span><br><span class=\"line\">sudo service mysql start</span><br><span class=\"line\">sudo mysql_secure_installation # follow instructions</span><br></pre></td></tr></table></figure>\n<h2 id=\"Step-3-install-Install-PHP-FPM\"><a href=\"#Step-3-install-Install-PHP-FPM\" class=\"headerlink\" title=\"Step 3, install Install PHP-FPM\"></a>Step 3, install Install PHP-FPM</h2><figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install php-fpm php-mysql php-gd php-cli php-xml php-mbstring</span><br></pre></td></tr></table></figure>\n<p>Add cgi.fix_pathinfo=0 to php.ini, if you know how to add, jump to step 4, otherwise, continue below.</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># if you use different version of PHP, change 7.0 to your version e.g. 8.0</span><br><span class=\"line\">sudo nano /etc/php/7.0/fpm/php.ini</span><br><span class=\"line\"></span><br><span class=\"line\"># paste cgi.fix_pathinfo=0</span><br><span class=\"line\"># press ctrl + X key, and type Y to save the file.</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># restart PHP-FPM service</span><br><span class=\"line\"># if you use different version of PHP, change the 7.0 accordingly</span><br><span class=\"line\">sudo service php7.0-fpm restart</span><br></pre></td></tr></table></figure>\n<h2 id=\"Step-4-configure-Nginx-to-use-PHP-FPM-to-process-php-files\"><a href=\"#Step-4-configure-Nginx-to-use-PHP-FPM-to-process-php-files\" class=\"headerlink\" title=\"Step 4, configure Nginx to use PHP-FPM to process php files\"></a>Step 4, configure Nginx to use PHP-FPM to process php files</h2><figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo nano /etc/nginx/sites-available/default</span><br><span class=\"line\"></span><br><span class=\"line\"># add the following to the server { } block</span><br><span class=\"line\"></span><br><span class=\"line\">                location ~ \\.php$ {</span><br><span class=\"line\">                try_files $uri =404;</span><br><span class=\"line\">                fastcgi_split_path_info ^(.+\\.php)(/.+)$;</span><br><span class=\"line\">                fastcgi_pass unix:/var/run/php/php7.0-fpm.sock;</span><br><span class=\"line\">                fastcgi_index index.php;</span><br><span class=\"line\">                fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</span><br><span class=\"line\">                include fastcgi_params;</span><br><span class=\"line\">                        }</span><br></pre></td></tr></table></figure>\n<p>Restart Nginx</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo service nginx restart</span><br></pre></td></tr></table></figure>\n<h2 id=\"Step-5-add-Microcaching-to-Nginx\"><a href=\"#Step-5-add-Microcaching-to-Nginx\" class=\"headerlink\" title=\"Step 5, add Microcaching to Nginx\"></a>Step 5, add Microcaching to Nginx</h2><p>With Microcaching, Nginx can handle large amount of traffic because dynamic inquiries/files are cached to prevent overloading your database. For example if each client to your website generate 2 database inquiry, 1000 client will have 2000 inquires. If you set up cache for 5 seconds, 1000 clients within 5 seconds will only hit your database 2 times if both inquires are cached. That is the magic of this setup.</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># always backup the file you want to change</span><br><span class=\"line\">sudo cp /etc/nginx/sites-available/default /etc/nginx/sites-available/default.bak</span><br><span class=\"line\">sudo nano /etc/nginx/sites-available/default</span><br></pre></td></tr></table></figure>\n<p>Add the following to the file. You can add this before the server {} block</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># Microcaching</span><br><span class=\"line\">fastcgi_cache_path /var/run/nginx-cache levels=1:2 keys_zone=qualityology-com:100m inactive=60m;</span><br><span class=\"line\">fastcgi_cache_key &quot;$scheme$request_method$host$request_uri&quot;;</span><br></pre></td></tr></table></figure>\n<p>Add the following to location ~ \\.php$ {} block. Below configuration will set the cache to expire after 10 seconds, and no cache for logged in users and commenters. You can change the 10s to longer time, but 10s is long enough for your need.</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#Cache everything by default</span><br><span class=\"line\">set $no_cache 0;</span><br><span class=\"line\"></span><br><span class=\"line\">#Don&apos;t cache logged in users or commenters</span><br><span class=\"line\">if ( $http_cookie ~* &quot;comment_author_wordpress_(?!test_cookie)wp-postpass_&quot; ) {</span><br><span class=\"line\">        set $no_cache 1;</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\">#Don&apos;t cache the following URLs</span><br><span class=\"line\">if ($request_uri ~* &quot;/(wp-admin/wp-login.php)&quot;)</span><br><span class=\"line\">{</span><br><span class=\"line\">        set $no_cache 1;</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\">#matches keys_zone in fastcgi_cache_path</span><br><span class=\"line\">fastcgi_cache qualityology-com;</span><br><span class=\"line\"></span><br><span class=\"line\">#don&apos;t serve pages defined earlier</span><br><span class=\"line\">fastcgi_cache_bypass $no_cache;</span><br><span class=\"line\"></span><br><span class=\"line\">#don&apos;t cache pages defined earlier</span><br><span class=\"line\">fastcgi_no_cache $no_cache;</span><br><span class=\"line\"></span><br><span class=\"line\">#defines the default cache time</span><br><span class=\"line\">fastcgi_cache_valid any 10s;</span><br><span class=\"line\"></span><br><span class=\"line\">#unsure what the impacts of this variable is</span><br><span class=\"line\">fastcgi_max_temp_file_size 2M;</span><br><span class=\"line\"></span><br><span class=\"line\">#Use stale cache items while updating in the background</span><br><span class=\"line\">fastcgi_cache_use_stale updating error timeout invalid_header http_500;</span><br><span class=\"line\">fastcgi_cache_lock on;</span><br><span class=\"line\">fastcgi_cache_lock_timeout 10s;</span><br></pre></td></tr></table></figure>\n<p>Test if your configuration</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo nginx -t</span><br></pre></td></tr></table></figure>\n<p>If no error, reload your Nginx or restart it</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo service nginx start</span><br></pre></td></tr></table></figure>\n<h2 id=\"Step-6-install-WordPress\"><a href=\"#Step-6-install-WordPress\" class=\"headerlink\" title=\"Step 6, install WordPress\"></a>Step 6, install WordPress</h2><figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /var/www/html/</span><br><span class=\"line\">sudo wget http://wordpress.org/latest.tar.gz</span><br><span class=\"line\">sudo tar xzvf latest.tar.gz</span><br><span class=\"line\">sudo rm latest.tar.gz</span><br><span class=\"line\">sudo mv wordpress/* ./</span><br><span class=\"line\">sudo chown -R www-data:www-data /var/www/html/*</span><br></pre></td></tr></table></figure>\n<p>You are all set. Now, open your domain or IP to setup WordPress</p>\n",
            "tags": [
                "WordPress",
                "Nginx",
                "Server"
            ]
        },
        {
            "id": "https://www.qualityology.com/tech/build-an-extremely-fast-wordpress-gcp-part1-server/",
            "url": "https://www.qualityology.com/tech/build-an-extremely-fast-wordpress-gcp-part1-server/",
            "title": "Build an extremely fast WordPress with GCP Part 1: server",
            "date_published": "2017-09-18T04:16:14.000Z",
            "content_html": "<p>Can you get a super fast server free from Google? Yes, you can. Google Cloud Platform has free tier for US region server. If you are building a small WordPress website using light bandwidth, the free tier is more than sufficient. Free tier provide 720 hours of instance usage which will cover whole month of usage. The only downside is if your site use a lot of bandwidth you will be billed after 1GB of free egress bandwidth, but still cheap because 1 GB cost only&#xA0;$0.01 for US and 1 TB $0.12 - $0.23 depends on the regions. Most new sites use only small amount of bandwidth. Ingress is free if you wonder. As of today, the free tier offer:</p>\n<blockquote>\n<ul>\n<li>  1 f1-micro instance per month (US regions only - Excluding Northern Virginia)</li>\n<li>  30 GB-months HDD, 5 GB-months snapshot</li>\n<li>  1 GB network egress from North America to all region destinations per month (excluding China and Australia)</li>\n</ul>\n</blockquote>\n<h2 id=\"Step-1-update-your-billing-info\"><a href=\"#Step-1-update-your-billing-info\" class=\"headerlink\" title=\"Step 1, update your billing info.\"></a>Step 1, update your billing info.</h2><p>Open <a href=\"https://console.cloud.google.com/billing\">https://console.cloud.google.com/billing</a>, update your billing info. You may be requested to create a project name.</p>\n<h2 id=\"Step-2-create-your-virtual-server-instance\"><a href=\"#Step-2-create-your-virtual-server-instance\" class=\"headerlink\" title=\"Step 2, create your virtual server (instance)\"></a>Step 2, create your virtual server (instance)</h2><p>Open <a href=\"https://console.cloud.google.com/compute\">https://console.cloud.google.com/compute</a> and click CREATE INSTANCE. <img src=\"/2017/09/create_instance-b838d66311ba7559ae40ad101f3b8bc2.png\"></p>\n<h2 id=\"Step-3-configure-your-server\"><a href=\"#Step-3-configure-your-server\" class=\"headerlink\" title=\"Step 3, configure&#xA0;your server.\"></a>Step 3, configure&#xA0;your server.</h2><p>Match the free tier configuration, do not click create&#xA0;yet after this step.</p>\n<ul>\n<li>  <strong>Zone</strong>: pick a US region. eg: us-west1-a</li>\n<li>  <strong>Machine type</strong>: micro (1 shared vCPU, 0.6 GB memory, f1-micro)</li>\n<li>  <strong>Boot disk</strong>: 30 GB standard persistent disk. SSD is not free!</li>\n<li>  <strong>OS images</strong>: pick one of your favor, or use&#xA0;Debian GNU/Linux 9 (stretch) as what we picked.</li>\n<li>  <strong>Firewall</strong>: check Allow HTTP traffic and Allow HTTPS traffic</li>\n</ul>\n<h2 id=\"Step-4-get-an-static-IP-for-your-instance\"><a href=\"#Step-4-get-an-static-IP-for-your-instance\" class=\"headerlink\" title=\"Step 4: get an static IP for your instance.\"></a>Step 4: get an static IP for your instance.</h2><p>Expand&#xA0;Management, disks, networking, SSH keys <img src=\"https://www.qualityology.com/2017/09/instance_config_micro-c43f1252c0868e29e21c7ae503c68747.png\"> Under Networking &gt;&gt; Network interfaces &gt;&gt; External IP, select Create IP address <img src=\"/2017/09/instance_static_ip-2dbd3c23a2bbbdf99ead0fdc9283e895.png\"> After you reserve an static external IP address, you can click Create to finish the instance setup. You have complete the step 1 and you have your&#xA0;free server from GCP, continue to <a href=\"https://www.qualityology.com/tech/build-extremely-fast-wordpress-gcp-part-2-nginx/\">part 2</a> when you ready.</p>\n",
            "tags": [
                "WordPress",
                "Nginx",
                "Server"
            ]
        },
        {
            "id": "https://www.qualityology.com/tech/wordpress-mobile-site-seo-vary-http-header/",
            "url": "https://www.qualityology.com/tech/wordpress-mobile-site-seo-vary-http-header/",
            "title": "Wordpress Mobile Site SEO: Vary HTTP header",
            "date_published": "2014-08-19T04:42:29.000Z",
            "content_html": "<p>Google&#x2019;s recommendation for Smartphone-optimized Websites recommends use Vary HTTP header when using mobile site dynamically serving different HTML on the same URL. Google recommend that the server send a hint to request that Googlebot for smartphones should crawl the page, too, and thus discover the mobile content. This hint is implemented using the Vary HTTP header.</p>\n<blockquote>\n<p>After the Content-Type header, a Vary header is sent to (if I understand it correctly) tell intermediate caches, like proxy servers, that the content type of the document varies depending on the capabilities of the client which requests the document.</p>\n</blockquote>\n<p>The Vary HTTP header has two important and useful implications according to Google:</p>\n<ol>\n<li> It signals to caching servers used in ISPs and elsewhere that they should consider the user agent when deciding whether to serve the page from cache or not. Without the Vary HTTP header, a cache may mistakenly serve mobile users the cache of the desktop HTML page or vice versa.</li>\n<li> It helps Googlebot discover your mobile-optimized content faster, as a valid Vary HTTP header is one of the signals we may use to crawl URLs that serve mobile-optimized content.</li>\n</ol>\n<p>By default, browser will get header from WordPress website like this:</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">HTTP/1.1 200 OK</span><br><span class=\"line\">Content-Type: text/html</span><br><span class=\"line\">Connection: Keep-Alive</span><br><span class=\"line\">(... rest of HTTP response headers...)</span><br></pre></td></tr></table></figure>\n<p>All you need to do is paste the following code into the funcions.php file of theme:</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function add_vary_header($headers) {</span><br><span class=\"line\">    $headers[&apos;Vary&apos;] = &apos;User-Agent&apos;;</span><br><span class=\"line\">    return $headers;</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\">add_filter(&apos;wp_headers&apos;, &apos;add_vary_header&apos;);</span><br></pre></td></tr></table></figure>\n<p>You will get a header similar like this Which means that the contents of the response &#x201C;will vary&#x201D; depending on the user agent that requests the page.</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">HTTP/1.1 200 OK</span><br><span class=\"line\">Content-Type: text/html</span><br><span class=\"line\">Vary: User-Agent</span><br><span class=\"line\">Connection: Keep-Alive</span><br><span class=\"line\">(... rest of HTTP response headers...)</span><br></pre></td></tr></table></figure>\n<p>This tiny SEO trick will not change anything besides adding one line into the header response code. <img src=\"/2014/08/vary-header-c04de43d038b4b3dc9913bf6b4d63bd3.png\" alt=\"Vary Header\"></p>\n",
            "tags": [
                "WordPress",
                "SEO"
            ]
        }
    ]
}