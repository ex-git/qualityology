{
    "version": "https://jsonfeed.org/version/1",
    "title": "Qualityology - Let's get the most out of life! â€¢ All posts by \"apache\" tag",
    "description": "To uncover the best way to achieve desired level of quality in everything. - We dive deep on adding quality to tech gadgets, business, and entertainment because quality matter in life.",
    "home_page_url": "https://www.qualityology.com",
    "items": [
        {
            "id": "https://www.qualityology.com/tech/stop-automated-comment-spam-brute-force-login-attack/",
            "url": "https://www.qualityology.com/tech/stop-automated-comment-spam-brute-force-login-attack/",
            "title": "Protect your WordPress from Automated Comment Spam and Brute Force Login Attack",
            "date_published": "2018-04-12T23:57:49.000Z",
            "content_html": "<p>Is your WordPress flooded with spam comment or being attacked by brute force login attempt? Thinking about spam blocking plugin? There are a lot of plug in can help you stop spam comment. You will notice it put thousands spam comments into spam folder after a while. Those Anti-Spam did a great job stopping spam comment show up in our post. There is some drawbacks for that kind of plugin. First,spam comments will be processed and store in your database before it gets deleted manually or automatically. Second, plugin like Akismet Anti-Spam will add a java-script to your site. If your site has limited resources, these kind of activities will drag down your site&#x2019;s performance. If you use captcha plugin, you will also interrupt user&#x2019;s experience.</p>\n<p>If you are looking for a light way to block the spam bot before the comment get posted. Yes, we have one. We can block the spam bot and also protect your login page at the same time, Spam bots&#x2019; comments will not even reach the server. Unless you got hit with spam from real human. This method is almost perfect and very light to your server. It has no captcha, no moderation queues, no complicate settings page, and 99.99% filter rate. This idea is inspired by this <a href=\"https://www.rtcx.net/stop-automated-comment-spam-wordpress\">Stop Automated Comment Spam on WordPress with Nginx.</a> <strong>How this work?</strong> Most spam bot will not process contents from server, including js and cookies. Their job is to get the comment form and post. So we can use java-script and cookies to block spam bot when they try to post any word.</p>\n<ul>\n<li>  When post is viewed, browser will set a small cookie named _pass into viewer&#x2019;s system.</li>\n<li>  If viewer attempted to post a comment, Nginx or Apache will check if they have that cookie in their system. Comment will go through if cookie found. Otherwise, it will shows 403 to block the access.</li>\n<li>  Since the cookie is set no matter viewer is attempt to leave comment or not, we can use the same cookie to prevent brute force login attack. Most spam bot and attack tools are not able to store cookie so the same theory work for both.</li>\n</ul>\n<p><strong>What you need?</strong></p>\n<ul>\n<li>  Access to server&#x2019;s configuration file.&#xA0;(Nginx or Apache&#x2019;s config file)</li>\n<li>  Ability to change something.</li>\n</ul>\n<h2 id=\"Step-one-add-code-to-set-cookie\"><a href=\"#Step-one-add-code-to-set-cookie\" class=\"headerlink\" title=\"Step one, add code to set cookie.\"></a>Step one, add code to set cookie.</h2><p>You can add below code via Code Snippets or directly to theme&#x2019;s function.php file. For HTTPS:</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function set_post_cookie() {</span><br><span class=\"line\">echo &apos;&lt;script&gt;document.cookie = &quot;_pass=1; max-age=43200; path=/; secure&quot;;&lt;/script&gt;&apos; . &quot;n&quot;; </span><br><span class=\"line\">}</span><br><span class=\"line\">add_action( &apos;comment_form&apos;, &apos;set_post_cookie&apos;, 100 );</span><br></pre></td></tr></table></figure>\n<p>This will set a cookie &#x201C;human&#x201D; and value is &#x201C;1&#x201D;. You can change the cookie name and value to whatever you want. If you use HTTP, remove the the work secure from above code.</p>\n<h2 id=\"Step-two-add-below-code-to-check-and-block-spam-bot-with-Nginx-Apache\"><a href=\"#Step-two-add-below-code-to-check-and-block-spam-bot-with-Nginx-Apache\" class=\"headerlink\" title=\"Step two, add below code to check and block spam bot with Nginx/Apache\"></a>Step two, add below code to check and block spam bot with Nginx/Apache</h2><p><strong>For NGINX:</strong></p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#Stop Automated Comment Spam and log in attempt with Nginx</span><br><span class=\"line\">if ($request_uri ~* /wp.comments.post.php/wp-login.php) { set $block_flag 1; }</span><br><span class=\"line\">if ($http_cookie ~* _pass) { set $block_flag 0; }</span><br><span class=\"line\">if ($block_flag) {</span><br><span class=\"line\">        return 403;</span><br><span class=\"line\">    }</span><br></pre></td></tr></table></figure>\n<p><strong>For Apache:</strong></p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">RewriteCond %{REQUEST_URI} ^/wp.comments.post.php?$ [OR]</span><br><span class=\"line\">RewriteCond %{REQUEST_URI} ^(.*)?wp-login\\.php(.*)$</span><br><span class=\"line\">RewriteCond %{HTTP_COOKIE} !_pass</span><br><span class=\"line\">RewriteRule ^forbid/(.*)$ - [F]</span><br></pre></td></tr></table></figure>\n<h2 id=\"Step-three-reset-the-cookie-for-failed-login-attempt\"><a href=\"#Step-three-reset-the-cookie-for-failed-login-attempt\" class=\"headerlink\" title=\"Step three, reset the cookie for failed login attempt\"></a>Step three, reset the cookie for failed login attempt</h2><p>Every time incorrect login attempted cookie will be remove to prevent brute force login attack. Add below codes to functions.php of your theme</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function no_wordpress_errors(){</span><br><span class=\"line\">echo &apos;&lt;script&gt;document.cookie = &quot;_pass=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; secure&quot;;&lt;/script&gt;&apos; . &quot;&quot;;</span><br><span class=\"line\">$ip=$_SERVER[&apos;REMOTE_ADDR&apos;];</span><br><span class=\"line\">$message = &quot;Your are blocked. IP address $ip&quot;;</span><br><span class=\"line\">return $message;</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\">add_filter( &apos;login_errors&apos;, &apos;no_wordpress_errors&apos;);</span><br></pre></td></tr></table></figure>\n<h3 id=\"JavaScript-must-be-turned-on-and-browser-must-accept-cookie-for-this-system-to-work\"><a href=\"#JavaScript-must-be-turned-on-and-browser-must-accept-cookie-for-this-system-to-work\" class=\"headerlink\" title=\"JavaScript must be turned on and browser must accept cookie for this system to work.\"></a>JavaScript must be turned on and browser must accept cookie for this system to work.</h3><p>Remember! Next time when you try to login your admin page, open a post first so you will have the cookie and will not be blocked by this.</p>\n",
            "tags": [
                "WordPress",
                "Apache",
                "Nginx"
            ]
        },
        {
            "id": "https://www.qualityology.com/tech/setup-log-rotation-for-apache-access-logs-error-logs-using-cronolog/",
            "url": "https://www.qualityology.com/tech/setup-log-rotation-for-apache-access-logs-error-logs-using-cronolog/",
            "title": "Setup log rotation for Apache access logs error logs using cronolog",
            "date_published": "2014-07-30T18:33:13.000Z",
            "content_html": "<p>If you want Apache log file to be saved on daily basis automatically. Cronolog is one of the best way to do it. Although Apache itself has rotatelogs for rotating activities, rotatelogs are not really creating log file everyday based on the calendar date. Rotatelogs creates and saves log files based on the rotation time or file size limits. For example we set up rotatelogs to rotate logs every 86400 seconds, technically is 24 hours, the start time is whenever you start ratatelogs, not from 00:00:00AM as what people normally assume. For how to setup rotatelogs, you can follow the instruction here: <a href=\"https://www.qualityology.com/tech/rotate-apache-logs-on-daily-basis-using-rotatelogs/\" title=\"Rotate Apache logs on a daily basis using rotatelogs in CentOS Apache 2.x\">Rotate Apache logs on a daily basis using rotatelogs</a> Cronolog is a simple filter program that reads log file entries from standard input and writes each entry to the output file specified by a filename template and the current date and time. cronolog is intended to be used in conjunction with a Web server, such as Apache, to split the access log into daily or monthly logs. If you want your log files start from 0:00 to the exact end of a day 23:59, cronolog can handle that. <strong>1. Install Cronolog.</strong> For Debian, Ubuntu, or Linux distributions using apt-get</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">apt-get install cronolog</span><br></pre></td></tr></table></figure>\n<p>For CentOS</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install cronolog</span><br></pre></td></tr></table></figure>\n<p><strong>2. Modify Apache&#x2019;s configuration file.</strong> For access logs, replace the following line</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CustomLog logs/access_log combined</span><br></pre></td></tr></table></figure>\n<p>to</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CustomLog &quot;cronolog /var/log/httpd/access_log.%Y-%m-%d&quot; combined</span><br></pre></td></tr></table></figure>\n<p>For error logs, replace the following line</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ErrorLog logs/error_log</span><br></pre></td></tr></table></figure>\n<p>to</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ErrorLog &quot;cronolog /var/log/httpd/error_log.%Y-%m-%d&quot;</span><br></pre></td></tr></table></figure>\n<p><strong>3. Check configuration syntax.</strong> Run the command below to check the configuration syntax.</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/usr/sbin/apachectl configtest</span><br><span class=\"line\"></span><br><span class=\"line\">Syntax OK</span><br></pre></td></tr></table></figure>\n<p><strong>4. Restart Apache.</strong> The apachectl graceful command tells Apache that you want to restart the server gracefully without aborting any open connections. It automatically checks the configuration files before initiating the restart to make sure Apache doesn&#x2019;t die.</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/usr/sbin/apachectl graceful</span><br></pre></td></tr></table></figure>\n<p>If apachectl graceful doesn&#x2019;t restart your server, there are a few other things you can try.</p>\n<ul>\n<li>  <strong>apachectl restart</strong> to restart the server. If the server is not running it is started. This command also runs a configuration test to make sure Apache won&#x2019;t die when it restarts.</li>\n<li>  <strong>apachectl stop</strong> to stop the Apache server</li>\n<li>  <strong>apachectl start</strong> to start the Apache server (will throw an error message if Apache is running)</li>\n<li>  <strong>apachectl configtest</strong> to test the configuration file syntax.</li>\n</ul>\n<p>For cronolog usage details, <a href=\"http://cronolog.org/usage.html\" title=\"cronolog usage\">click here</a>.</p>\n",
            "tags": [
                "Apache"
            ]
        },
        {
            "id": "https://www.qualityology.com/tech/rotate-apache-logs-on-daily-basis-using-rotatelogs/",
            "url": "https://www.qualityology.com/tech/rotate-apache-logs-on-daily-basis-using-rotatelogs/",
            "title": "Rotate Apache logs on a daily basis using rotatelogs",
            "date_published": "2014-07-28T19:06:23.000Z",
            "content_html": "<p>If you Apache to start a new log file every day automatically, rotatelogs is the simple way to do it. Rotatelogs is a simple program for use in conjunction with Apache&#x2019;s piped logfile feature. It supports rotation based on a time interval or maximum size of the log. The use of rotatelogs is actually quite simple. Search your httpd.conf and replace the following line</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CustomLog logs/access_log combined</span><br></pre></td></tr></table></figure>\n<p>to</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CustomLog &quot;/usr/sbin/rotatelogs /var/log/httpd/access_log.%Y-%m-%d 86400&quot; combined</span><br></pre></td></tr></table></figure>\n<p>86400 (= 60 * 60 * 24) which causes a new log file each day at midnight The rotatelogs in default record log using GMT time. If your system is using local time rather than GMT, you need to add -l option.</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CustomLog &quot;/usr/sbin/rotatelogs -l /var/log/httpd/access_log.%Y-%m-%d 86400&quot; combined</span><br></pre></td></tr></table></figure>\n<p>Now check if the syntax is OK and give Apache a graceful. Run the command below to check the configuration syntax.</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/usr/sbin/apachectl configtest</span><br><span class=\"line\"></span><br><span class=\"line\">Syntax OK</span><br></pre></td></tr></table></figure>\n<p>Graceful restart. The apachectl graceful command tells Apache that you want to restart the server gracefully without aborting any open connections. It automatically checks the configuration files before initiating the restart to make sure Apache doesn&#x2019;t die.</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/usr/sbin/apachectl graceful</span><br></pre></td></tr></table></figure>\n<p>If apachectl graceful doesn&#x2019;t restart your server, there are a few other things you can try.</p>\n<ul>\n<li>  <strong>apachectl restart</strong> to restart the server. If the server is not running it is started. This command also runs a configuration test to make sure Apache won&#x2019;t die when it restarts.</li>\n<li>  <strong>apachectl stop</strong> to stop the Apache server</li>\n<li>  <strong>apachectl start</strong> to start the Apache server (will throw an error message if Apache is running)</li>\n<li>  <strong>apachectl configtest</strong> to test the configuration file syntax.</li>\n</ul>\n",
            "tags": [
                "Apache"
            ]
        },
        {
            "id": "https://www.qualityology.com/tech/apache-blocking-bad-bots-attacks-zmeu/",
            "url": "https://www.qualityology.com/tech/apache-blocking-bad-bots-attacks-zmeu/",
            "title": "Apache: Blocking bad bots attacks from ZmEu",
            "date_published": "2014-07-17T18:14:18.000Z",
            "content_html": "<p>Take a quick look at Apache&#x2019;s access.log, there are always all sorts of unknown IPs are connecting, mostly with a status code 403, 404. For example, Some bots like ZmEu are trying to find phpmyadmin or other unprotect web server. ZmEu is a script built by a group of Romanian Hackers. This script essentially looks for a set of scripts and directories of common interest, like for example /phpMyAdmin/*, /pma/* what it is actually looking for is unprotect scripts and other things that might allow the foreign host access into something valuable. such as such as your MySQL databases! An example of ZmEu scan logs. If you see the status code is 403 or 404, your are mostly OK. If the status code is 200, you might need to find out what ZmEu already found out. It&#x2019;s only dangerous if you have unpatched or unprotected versions of software on the host that may be vulnerable.</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">186.42.181.66 - - [17/Jul/2014:08:29:35 -0700] &quot;GET /phpMyAdmin/scripts/setup.php HTTP/1.1&quot; 403 230 &quot;-&quot; &quot;ZmEu&quot;</span><br><span class=\"line\">186.42.181.66 - - [17/Jul/2014:08:29:36 -0700] &quot;GET /phpmyadmin/scripts/setup.php HTTP/1.1&quot; 403 230 &quot;-&quot; &quot;ZmEu&quot;</span><br><span class=\"line\">186.42.181.66 - - [17/Jul/2014:08:29:36 -0700] &quot;GET /pma/scripts/setup.php HTTP/1.1&quot; 404 2946 &quot;-&quot; &quot;ZmEu&quot;</span><br><span class=\"line\">190.95.232.234 - - [17/Jul/2014:08:29:36 -0700] &quot;GET /myadmin/scripts/setup.php HTTP/1.1&quot; 404 2948 &quot;-&quot; &quot;ZmEu&quot;</span><br><span class=\"line\">190.95.232.234 - - [17/Jul/2014:08:29:37 -0700] &quot;GET /MyAdmin/scripts/setup.php HTTP/1.1&quot; 404 2949 &quot;-&quot; &quot;ZmEu&quot;</span><br></pre></td></tr></table></figure>\n<p><strong>How to stop ZmEu?</strong> IP blocking is not a essential way to fix this problem because ZmEu scan can be executed from any IP address. An easy quick fix to rid of almost all ZmEu attacks is block all http-agent contains &#x201C;ZmEu&#x201D; because the http-agent that ZmEu uses is &#x201C;ZmEu&#x201D;. Lets block it on an Apache global level, add this to any of your virtual host or host directives (httpd.conf or *.conf or .htaccess):</p>\n<figure class=\"highlight plain hljs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">order allow,deny  </span><br><span class=\"line\"># deny based on User-Agent</span><br><span class=\"line\">SetEnvIfNoCase User-Agent &quot;^ZmEu&quot; bad_bot</span><br><span class=\"line\">deny from env=bad_bot</span><br><span class=\"line\">allow from all</span><br></pre></td></tr></table></figure>\n<p>Then restart your Apache and enjoy.</p>\n",
            "tags": [
                "Apache"
            ]
        }
    ]
}